<h1>Liste des produits</h1>

@if (hasRoleAdmin) {
    <button *ngIf="!showForm" (click)="showForm = true" class="btn btn-light">Cliquer ici pour ajouter</button>

    <form *ngIf="showForm" (ngSubmit)="creerOuModifier()" [formGroup]="fournisseurForm">
        <div class="mb-3 row">
            <label for="name" class="col-sm-2 col-form-label">Nom</label>
            <div class="col-sm-10">
                <input type="text" class="form-control" id="name" formControlName="name" [class.is-invalid]="nameCtrl.invalid && (nameCtrl.dirty || nameCtrl.touched)" />

                @if (nameCtrl.hasError('required')) {
                    <div class="invalid-feedback">Le nom est obligatoire</div>
                }
            </div>
        </div>

        <div class="btn-group">
            @if (editingFournisseur) {
                <input type="submit" [disabled]="fournisseurForm.invalid" class="btn btn-warning" value="Modifier" />
            }

            @else {
                <input type="submit" [disabled]="fournisseurForm.invalid" class="btn btn-success" value="CrÃ©er" />
            }

            <button type="button" class="btn btn-danger" (click)="annulerEditer()">Annuler</button>
        </div>
    </form>

    <hr />
}

<table class="table table-striped">
    <thead>
        <tr>
            <th>Nom</th>
        </tr>
    </thead>

    <tbody>
        <tr *ngFor="let fournisseur of fournisseurs$ | async; trackBy: trackFournisseur">
            <td>
                <a [routerLink]="[ '/fournisseur', fournisseur.id ]">{{ fournisseur.libelle }}</a>
            </td>
        </tr>
    </tbody>
</table>
